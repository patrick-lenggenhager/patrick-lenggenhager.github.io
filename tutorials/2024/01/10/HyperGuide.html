<!doctype html>
<html lang="en">
	<head>
	<link href="http://gmpg.org/xfn/11" rel="profile">
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="google-site-verification" content="z6PptFpGBLy-ovj-9Xw1PXLnaYBOb8-dNpevc76Py_Y" />
	
	<script id="MathJax-script" defer
		src="https://cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/tex-mml-chtml.js">
	</script>

	<title>Getting Started with HyperCells and HyperBloch - Patrick M. Lenggenhager</title>

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/assets/academicons/css/academicons.min.css"/>
	<script src="https://kit.fontawesome.com/1d410b0e3c.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	<link href="/css/prism.css" rel="stylesheet"/>
</head>

	<body>
		<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #121254;">
	<div class="container">
		<a class="navbar-brand" href="/">Patrick M. Lenggenhager</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarResponsive">
			<ul class="navbar-nav">
				
					<li class="nav-item">
						<a class="nav-link" href="/">Home</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/resint.html">Research Interests</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/projects.html">Projects</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/publications.html">Publications</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/software.html">Software</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/tutorials.html">Tutorials</a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="/contact.html">Contact</a>
					</li>
				
			</ul>
		</div>
	</div>
</nav>

			<div class="container match-braces" style="margin-top: 25px;">
				<h2 id="efficient-modeling-of-tight-binding-models-on-hyperbolic-lattices">Efficient Modeling of Tight-Binding Models on Hyperbolic Lattices</h2>

<h3 id="table-of-contents">Table of Contents</h3>

<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#getting-started">Getting Started</a></li>
</ul>

<h3 id="overview">Overview</h3>

<p>The task of modeling tight-binding models on hyperbolic lattices is split into two steps:</p>
<ol>
  <li><strong>Constructing the lattice/model graph</strong>
 For finite systems, this includes the construction of appropriate periodic boundary conditions, while for infinite systems, the corresponding primitive cell and successive supercells are constructed in order to apply the supercell method for hyperbolic band theory. This part is implemented in the <a href="https://www.gap-system.org" target="_blank">GAP</a> package <a href="https://github.com/patrick-lenggenhager/HyperCells" target="_blank">HyperCells</a>. Additionally, the package determines maximally-symmetric Wyckoff positions and simplifies dealing with translation and point group symmetries on the hyperbolic lattice. The package also allows the definition of the graph underlying a specific model, i.e., selecting specific Wyckoff positions, nearest or next-nearest neighbors etc.</li>
  <li><strong>Defining tight-binding models and using hyperbolic band theory</strong>
 The second package, a Mathematica package called <a href="https://github.com/patrick-lenggenhager/HyperBloch" target="_blank">HyperBloch</a> provides functions for importing and easily visualizing the clusters, supercells, and model graphs. Additionally, it allows the user to easily define tight-binding models ontop of the model graph, by placing orbitals at vertices and definining hopping matrices on the edges. Finally, the Abelian Bloch Hamiltonian for the defined model is constructed and thus allows to study eigenstates and eigenvalues.</li>
</ol>

<p>Note that the output of the HyperCells package, i.e., the cell and model graphs can be read by any programming language, such that using the HyperBloch package is not strictly necessary. The <a href="https://patrick-lenggenhager.github.io/HyperCells/doc/chap7_mj.html#X8091CEE880E799B4" target="_blank">file format definitions</a> can be found in the <a href="https://patrick-lenggenhager.github.io/HyperCells/doc/chap0_mj.html" target="_blank">documentation</a>.</p>

<h4 id="supercell-method">Supercell Method</h4>

<p>Hyperbolic lattices were recently theoretically described by a non-Abelian generalization of the Bloch theorem, but practical approaches for efficient computations have remained missing. Our proposed “supercell method” overcomes the challenges posed by noncommuting translations, and enables significant progress towards an analytical description of hyperbolic lattice models in momentum space. Specifically, we use computational group theory to create a sequence of progressively larger unit cells, each formed as a symmetric aggregate of smaller unit cells. We apply the previously established Abelian hyperbolic band theory — which ignores the noncommutativity of translations — to those growing supercells and obtain a converging description of the infinite lattice.</p>

<p>An introduction to the relevant concepts, can be found in Chapter 9 and 10 of the doctoral thesis</p>
<blockquote>
  <p>P. M. Lenggenhager, <em>Emerging avenues in band theory: multigap topology and hyperbolic lattices</em>, PhD thesis, ETH Zurich, <a href="https://doi.org/10.3929/ethz-b-000645370" target="_blank">10.3929/ethz-b-000645370</a> (2023)</p>
</blockquote>

<p>or in the article</p>
<blockquote>
  <p>P. M. Lenggenhager, J. Maciejko, and T. Bzdušek, <em>Non-Abelian hyperbolic band theory from supercells</em>, <a href="https://doi.org/10.1103/PhysRevLett.131.226401" target="_blank">Phys. Rev. Lett. <strong>131</strong>, 226401</a> (2023)</p>
</blockquote>

<h3 id="installation">Installation</h3>

<h4 id="hypercells">HyperCells</h4>

<p><strong>Prerequisite</strong>: GAP version 4.11+</p>

<p>First install GAP by following the <a href="https://www.gap-system.org/Download/index.html" target="_blank">instructions</a> on the GAP website. In most cases, this boils down to the following steps (to be executed in the directory where GAP should be installed to):</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>build-essential autoconf libtool libgmp-dev libreadline-dev zlib1g-dev
wget https://github.com/gap-system/gap/releases/download/v4.12.2/gap-4.12.2.tar.gz
<span class="nb">tar</span> <span class="nt">-zxf</span> gap-4.12.2.tar.gz
<span class="nb">cd </span>gap-4.12.2/
./configure
make
<span class="nb">cd </span>pkg
../bin/BuildPackages.sh
<span class="nb">cd</span> ..
</code></pre></div></div>
<p>You might want to link the executable to <code class="language-plaintext highlighter-rouge">~/bin/gap</code>:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-s</span> gap-4.12.2/gap ~/bin/gap
</code></pre></div></div>
<p>and add <code class="language-plaintext highlighter-rouge">~/bin/</code> to your path if you have not done so yet:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"export PATH=</span><span class="se">\"</span><span class="nv">$PATH</span><span class="s2">:~/bin</span><span class="se">\"</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ~/.bashrc
</code></pre></div></div>

<p>The HyperCells package is most easily installed by simply cloning the git repository in the user’s GAP package directory:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/.gap/pkg
<span class="nb">cd</span> ~/.gap/pkg
git clone https://github.com/patrick-lenggenhager/HyperCells.git
</code></pre></div></div>
<p>To update it to the most recent version, simply pull:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/.gap/pkg/HyperCells
git pull
</code></pre></div></div>

<h4 id="hyperbloch">HyperBloch</h4>

<p><strong>Prerequisites/Dependencies</strong>:</p>
<ul>
  <li>Wolfram Language Interpreter such as <a href="https://www.wolfram.com/engine" target="_blank">Wolfram Language Engine</a> or <a href="https://www.wolfram.com/mathematica" target="_blank">Mathematica</a> with Wolfram Language 12+ (13+ is recommended)</li>
  <li><a href="https://github.com/NCAlgebra/NC" target="_blank">NCAlgebra</a> package (version 6+)</li>
</ul>

<p>Assuming a Wolfram Language Interpreter is already installed, we first install its dependency NCAlgebra</p>
<pre><code class="language-Mathematica">PacletInstall["https://github.com/NCAlgebra/NC/blob/master/NCAlgebra-6.0.3.paclet?raw=true"];
</code></pre>
<p>and then the package itself as a paclet:</p>
<pre><code class="language-Mathematica">PacletInstall["https://github.com/patrick-lenggenhager/HyperBloch/releases/download/v0.9.0/PatrickMLenggenhager__HyperBloch-0.9.0.paclet"]
</code></pre>
<p>If necessary, update the version number to match the one of the <a href="https://github.com/patrick-lenggenhager/HyperBloch/releases/latest" target="_blank">latest release</a>. Alternatively, download the release file manually, and install it with <code class="language-Mathematica">PacletInstall["path"]</code> by passing the path to the downloaded file as argument.</p>

<h3 id="getting-started">Getting Started</h3>

<h5 id="hypercells-1">HyperCells</h5>

<p>To use the package, start gap and then load the package with</p>
<pre><code class="language-gap">gap&gt; LoadPackage("HyperCells");
</code></pre>
<p>A <a href="https://patrick-lenggenhager.github.io/HyperCells/doc/chap1_mj.html#X85861B017AEEC50B" target="_blank">basic example</a> including explanations can be found in the <a href="https://patrick-lenggenhager.github.io/HyperCells/doc/chap0_mj.html" target="_blank">documentation</a>, while more complicated examples, reproducing all our results from the paper can be found in the <a href="https://zenodo.org/records/10142168" target="_blank">Supplementary Data and Code</a>.</p>

<h5 id="hyperbloch-1">HyperBloch</h5>

<p>To use the package, load it using the command</p>
<pre><code class="language-Mathematica">&lt;&lt; PatrickMLenggenhager`HyperBloch`
</code></pre>
<p>A tutorial can be found in the documentation center, which can be opened with the command:</p>
<pre><code class="language-Mathematica">Documentation`HelpLookup["PatrickMLenggenhager/HyperBloch/tutorial/BasicUsage"];
</code></pre>
<p>More examples can be found in the specific function pages, for an overview, see</p>
<pre><code class="language-Mathematica">Documentation`HelpLookup["PatrickMLenggenhager/HyperBloch/guide/HyperBlochPackage"];
</code></pre>
<p>Again, the more complicated examples, reproducing all our results from the paper, can be found in the <a href="https:/doi.org/10.5281/zenodo.10142167" target="_blank">Supplementary Data and Code</a>.</p>

<h3 id="worked-out-example">Worked-Out Example</h3>

<p>The below example is taken from the <a href="https:/doi.org/10.5281/zenodo.10142167" target="_blank">Supplementary Data and Code</a> and demonstrates the necessary steps to find the density of states of an elementary nearest-neighbor hopping model on the \(\{8,8\}\) lattice.</p>

<p>In GAP, we first construct the primitive cell, then the model graph (based on the tessellation graph), and finally the 2-supercell:</p>
<pre><code class="language-gap"># load the HyperCells package
LoadPackage( "HyperCells" );

# set up (proper) triangle group
tg := ProperTriangleGroup( [ 2, 8, 8 ] );

# specify the quotient defining the primitive cell
qpc := TGQuotient( [ 2, 6 ] );

# construct symmetric primitive cell
cgpc := TGCellGraph( tg, qpc, 3 : simplify := 5 );
Export( cgpc, "(2,8,8)_T2.6_3.hcc" ); # export

# elementary nearest-neighbor model
model := TessellationModelGraph( cgpc, true : simplify := 5 );
Export( model, "{8,8}-tess_T2.6_3.hcm" ); # export

# construct symmetric supercell
sc := TGCellSymmetric( tg, TGQuotient( [ 3, 11 ] ), 3 );

# extend the model defined on the primitive cell to the supercell
scmodel := TGSuperCellModelGraph( model, sc : simplify := 0 );
Export( scmodel, "{8,8}-tess_T2.6_3_sc-T3.11.hcs" ); # export
</code></pre>
<div style="text-align: right;">
  <a href="/assets/misc/code_snippets/getting_started_HyperCells.g" download="" class="btn btn-primary">Download GAP Code</a>
</div>

<p>Next, in Mathematica, we load the package</p>
<pre><code class="language-Mathematica">&lt;&lt; PatrickMLenggenhager`HyperBloch`
</code></pre>
<p>and then the exported data:</p>
<pre><code class="language-Mathematica">SetDirectory[NotebookDirectory[]];

pcell = ImportCellGraphString[Import["(2,8,8)_T2.6_3.hcc"]];
pcmodel = ImportModelGraphString[Import["{8,8}-tess_T2.6_3.hcm"]];
scmodel = ImportSupercellModelGraphString[Import["{8,8}-tess_T2.6_3_sc-T3.11.hcs"]];
</code></pre>
<p>Note the use of the <code class="language-Mathematica">Import[]</code> function inside the <code class="language-Mathematica">ImportCellGraphString[]</code> function. This is necessary, because the exported file is a text file, which contains the string representation of the cell graph. The <code class="language-Mathematica">Import[]</code> function is used to read the file, while the <code class="language-Mathematica">ImportCellGraphString[]</code> function is used to parse the string and construct the cell graph. The same applies to the <code class="language-Mathematica">ImportModelGraphString[]</code> and <code class="language-Mathematica">ImportSupercellModelGraphString[]</code> functions.
Alternatively, we could have used the function <code class="language-gap">ExportString()</code> in GAP to export the cell graph as a string, copied the string into a Mathematica notebook, and then used the <code class="language-Mathematica">ImportCellGraphString[]</code> function (or one of the analogous functions) directly to parse the string and construct the cell graph.</p>

<p>The HyperBloch package provides convenient functions for visualizing the model:</p>
<pre><code class="language-Mathematica">VisualizeModelGraph[pcmodel,
	Elements -&gt; &lt;|
		ShowCellGraphFlattened -&gt; {},
		ShowCellBoundary -&gt; {ShowEdgeIdentification -&gt; True}
	|&gt;,
	CellGraph -&gt; pcell,
	NumberOfGenerations -&gt; 2,
	ImageSize -&gt; 300
]
</code></pre>
<p>producing the following output:</p>
<figure class="text-center">
  <picture>
    <source type="image/svg+xml" srcset="/assets/media/figs/HyperGuide/ENNM_88.svg" />
    <img src="/assets/media/figs/HyperGuide/ENNM_88.jpg" class="figure-img img-fluid rounded" alt="elementary nearest-neighbor model on the {8,8} lattice" width="400" />
  </picture>
  <figcaption class="figure-caption text-center">Fig. 1: Elementary nearest-neighbor model on the {8,8} lattice.</figcaption>
</figure>

<p>To construct the Abelian Bloch Hamiltonian for the given model, we use</p>
<pre><code class="language-Mathematica">FullSimplify[AbelianBlochHamiltonianExpression[pcmodel, 1, 0 &amp;, -1 &amp;, k]]
</code></pre>
<p>which results in</p>
<pre><code class="language-Mathematica">{ { -2 (Cos[k[1]] + Cos[k[2]] + Cos[k[3]] + Cos[k[4]]) } }
</code></pre>

<p>For more efficient evaluation, we precompile the Bloch Hamiltonian by specifying the option <code class="language-Mathematica">CompileFunction-&gt;True</code>:</p>
<pre><code class="language-Mathematica">Hpc = AbelianBlochHamiltonian[pcmodel, 1, 0 &amp;, -1 &amp;, CompileFunction -&gt; True];
</code></pre>
<p>To compute the density of states (DOS), we can now take advantage of the independence of different momentum sectors and therefore parallelize it:</p>
<pre><code class="language-Mathematica">ComputeDOS[cfH_, Npts_, Nruns_, {Emin_, Emax_}, dE_] := 
 Module[{data, tot, dimk = Length[cfH[[2]]]},
  data = 
   Transpose[{MovingAverage[Range[Emin, Emax, dE], 2], 
     Total@ParallelTable[
       HistogramList[
         Flatten@Table[
           Chop@Eigenvalues[cfH @@ RandomReal[{-Pi, Pi}, dimk]], {i, 
            1, Round[Npts/Nruns]}], {Emin, Emax, dE}][[2]], {j, 1, 
        Nruns}, Method -&gt; "FinestGrained"]}];
  tot = Total@data[[;; , 2]];
  {#1, #2/dE/tot} &amp; @@@ data
  ]
dospc = ComputeDOS[Hpc, 10^6, 32, {-8 - 0.005, 8}, 0.005];
</code></pre>
<p>We find:</p>
<figure class="text-center">
  <picture>
    <source type="image/svg+xml" srcset="/assets/media/figs/HyperGuide/dos_88_T2.6.svg" />
    <img src="/assets/media/figs/HyperGuide/dos_88_T2.6.jpg" class="figure-img img-fluid rounded" alt="density of Abelian Bloch states of the elementary nearest-neighbor model on the primitive cell T2.6 of the {8,8} lattice" width="400" />
  </picture>
  <figcaption class="figure-caption text-center">Fig. 2: Density of Abelian Bloch states of the elementary nearest-neighbor model on the primitive cell T2.6 of the ${8,8}$ lattice.</figcaption>
</figure>

<p>It is just as easy to apply the supercell method. For example, constructing the Abelian Bloch Hamiltonian on the larger supercell, which thus captures some of the higher-dimensional irreducible representations on the original primitive cell, and computing the resulting DOS can be done as follows:</p>
<pre><code class="language-Mathematica">Hsc = AbelianBlochHamiltonian[scmodel, 1, 0 &amp;, -1 &amp;, PCModel -&gt; pcmodel, CompileFunction -&gt; True];
dossc = ComputeDOS[Hsc, 10^4, 32, {-8 - 0.005, 8}, 0.005];
</code></pre>
<p>Performing the computations with higher momentum-resolution (\(10^9\) points) and for more supercells (up to 64 primitive cells), we can nicely observe the convergence of the DOS:</p>
<figure class="text-center">
  <picture>
    <source type="image/svg+xml" srcset="/assets/media/figs/HyperGuide/dos_88_scm.svg" />
    <img src="/assets/media/figs/HyperGuide/dos_88_scm.jpg" class="figure-img img-fluid rounded" alt="density of states of the elementary nearest-neighbor model on the {8,8} lattice as computed using the supercell method with sequence T2.6, T3.11, T5.13, T9.20, T17.29, T33.44, T65.78" width="400" />
  </picture>
  <figcaption class="figure-caption text-center">Fig. 3: Density of states of the elementary nearest-neighbor model on the {8,8} lattice as computed using the supercell method with sequence T2.6, T3.11, T5.13, T9.20, T17.29, T33.44, T65.78.</figcaption>
</figure>

<div style="text-align: right;">
  <a href="/assets/misc/code_snippets/getting_started_HyperBloch.nb" download="" class="btn btn-primary">Download Mathematica Notebook</a>
</div>
<p><br /></p>

			</div>
		<footer class="sticky-bottom" style="background-color: #121254;">
	<div class="container">
		<p class="m-0 copyright-text">Copyright &copy; 2024 Patrick M. Lenggenhager. Designed by Patrick M. Lenggenhager.</p>
	</div>
</footer>

		<script src="/js/jquery-3.3.1.min.js"></script>
		<script src="/js/bootstrap.min.js"></script>
        <script src="/js/prism.js"></script>
	</body>
</html>